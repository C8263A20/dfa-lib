!function t(e,n,r){function i(a,o){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!o&&l)return l(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(t){var n=e[a][1][t];return i(n?n:t)},h,h.exports,t,e,n,r)}return n[a].exports}for(var s="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t){(function(e){var n=t("dfa-lib");e.DFA=n.DFA,e.NFA=n.NFA,e.to_NFA=t("dfa-lib/regex")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"dfa-lib":10,"dfa-lib/regex":11}],2:[function(t,e){var n=t("./types").Rule,r=t("./assert");e.exports=function(t){function e(t,e){for(var n=[],r=0,i=1;e>=i;++r,i<<=1)i&e&&n.push(t[r]);return n}t.prototype.annotateNullables=function(){if(this.hasOwnProperty("nullables"))return this.nullables;this.nullables=[];for(var t=[],e=[],n=this.getReverseMap(),r=0;r<this.symbolsList.length;++r)this.symbolMap[this.symbolsList[r]].nullable=!1;for(var r=0;r<this.rules.length;++r){for(var i=0,s=this.rules[r],a=!0,o=0;o<s.production.length;++o){if("NT"!==s.production[o].type){a=!1;break}++i}e.push(a?i:0),0!=s.production.length||this.symbolMap[s.name].nullable||(this.symbolMap[s.name].nullable=!0,t.push(s.name),this.nullables.push(s.name))}for(var r=0;r<this.rules.length;++r)this.rules[r]._index=r;for(;t.length>0;)for(var l=t.pop(),r=0;r<n[l].length;++r){var u=n[l][r];0!==--e[u._index]||this.symbolMap[u.name].nullable||(this.symbolMap[u.name].nullable=!0,t.push(u.name),this.nullables.push(u.name))}for(var r=0;r<this.rules.length;++r)delete this.rules[r]._index;return this.nullables},t.prototype.annotateUnreachables=function(){if(this.hasOwnProperty("unreachables"))return this.unreachables;this.unreachables=[];for(var t=[this.start],e=0;e<this.symbolsList.length;++e)this.symbolMap[this.symbolsList[e]].unreachable=!0;for(this.symbolMap[this.start].unreachable=!1;t.length>0;)for(var n=t.pop(),r=0;r<this.symbolMap[n].rules.length;++r)for(var i=this.symbolMap[n].rules[r],s=0;s<i.production.length;++s){var a=i.production[s];"NT"===a.type&&this.symbolMap[a.data].unreachable&&(this.symbolMap[a.data].unreachable=!1,t.push(a.data))}for(var e=0;e<this.symbolsList.length;++e)this.symbolMap[this.symbolsList[e]].unreachable&&this.unreachables.push(this.symbolsList[e]);return this.unreachables},t.prototype.annotateUseless=function(){if(this.hasOwnProperty("uselesses"))return this.uselesses;this.uselesses=[];for(var t=[],e=[],n=this.getReverseMap(),r=0;r<this.symbolsList.length;++r)this.symbolMap[this.symbolsList[r]].useless=!0;for(var r=0;r<this.rules.length;++r){for(var i=0,s=this.rules[r],a=0;a<s.production.length;++a)"NT"===s.production[a].type&&++i;e.push(i),0==i&&this.symbolMap[s.name].useless&&(this.symbolMap[s.name].useless=!1,t.push(s.name))}for(var r=0;r<this.rules.length;++r)this.rules[r]._index=r;for(;t.length>0;)for(var o=t.pop(),r=0;r<n[o].length;++r){var l=n[o][r];0===--e[l._index]&&this.symbolMap[l.name].useless&&(this.symbolMap[l.name].useless=!1,t.push(l.name))}for(var r=0;r<this.symbolsList.length;++r)this.symbolMap[this.symbolsList[r]].useless&&this.uselesses.push(this.symbolsList[r]);for(var r=0;r<this.rules.length;++r)delete this.rules[r]._index;return this.uselesses},t.prototype.annotateSelfDeriving=function(){if(this.hasOwnProperty("selfDerivings"))return this.selfDerivings;this.selfDerivings=[],this.annotateNullables();for(var t={},e=0;e<this.symbolsList.length;++e)t[this.symbolsList[e]]={};t:for(var e=0;e<this.rules.length;++e){var n=this.rules[e].name,r=this.rules[e].production;if(0!=r.length){for(var i=0;i<r.length;++i)if("T"==r[i].type)continue t;if(1!=r.length){for(var s=null,i=0;i<r.length;++i)if(!this.symbolMap[r[i].data].nullable){if(null!==s)continue t;s=r[i].data}if(null!==s)t[n][s]=!0;else for(var i=0;i<r.length;++i)t[n][r[i].data]=!0}else t[n][r[0].data]=!0}}for(var e=0;e<this.symbolsList.length;++e)for(var i=0;i<this.symbolsList.length;++i)for(var a=0;a<this.symbolsList.length;++a)t[this.symbolsList[e]][this.symbolsList[a]]&&t[this.symbolsList[a]][this.symbolsList[i]]&&(t[this.symbolsList[e]][this.symbolsList[i]]=!0);for(var e=0;e<this.symbolsList.length;++e){var o=this.symbolsList[e];t[o][o]?(this.symbolMap[o].selfDeriving=!0,this.selfDerivings.push(o)):this.symbolMap[o].selfDeriving=!1}return this.selfDerivings},t.prototype.strippedUseless=function(){this.annotateUseless();for(var e=[],n=0;n<this.rules.length;++n){var i=this.rules[n];if(!this.symbolMap[i.name].useless){var s;for(s=0;s<i.production.length&&("NT"!=i.production[s].type||!this.symbolMap[i.production[s].data].useless);++s);s==i.production.length&&e.push(i)}}if(0==e.length)return{empty:!0};var a=t(e,this.start);return 0===a.symbolMap[a.start].rules.length?{empty:!0}:(r(0==a.annotateUseless().length,"Haven't actually eliminated all useless productions?"),a)},t.prototype.strippedUnreachable=function(){this.annotateUnreachables();for(var e=[],n=0;n<this.rules.length;++n){var i=this.rules[n];this.symbolMap[i.name].unreachable||e.push(i)}if(0==e.length)return{empty:!0};var s=t(e,this.start);return 0===s.symbolMap[s.start].rules.length?{empty:!0}:(r(0==s.annotateUnreachables().length,"Haven't actually eliminated all unreachable productions?"),s)},t.prototype.strippedUnitProductions=function(){function e(t){for(var e=0;e<s.length;++e)if(s[e].equals(t))return!0;for(var e=0;e<a.length;++e)if(a[e].equals(t))return!0;return!1}function r(t){e(t)||a.push(t)}for(var i=[],s=[],a=[],o=0;o<this.rules.length;++o){var l=this.rules[o];1!==l.production.length||"T"==l.production[0].type?i.push(l):r(l)}for(;a.length>0;){var l=a.pop();s.push(l);var u=l.production[0].data;if(u!==l.name)for(var h=0;h<this.symbolMap[u].rules.length;++h){var p=this.symbolMap[u].rules[h],c=n(l.name,p.production.slice(0));1!==c.production.length||"T"==c.production[0].type?i.push(c):r(c)}}return 0==i.length?{empty:!0}:t(i,this.start)},t.prototype.strippedDuplicates=function(){for(var e=[],n=0;n<this.rules.length;++n){var r,i=this.rules[n];for(r=0;r<e.length&&!e[r].equals(i);++r);r==e.length&&e.push(i)}return t(e,this.start)},t.prototype.stripped=function(){var t=this.strippedUnitProductions();return t.empty?t:(t=t.strippedUseless(),t.empty?t:(t=t.strippedUnreachable(),t.empty?t:(r(0==t.annotateUseless().length,"Suddenly there are more useless symbols?"),t=t.strippedDuplicates())))},t.prototype.deNulled=function(){var i=this.stripped();if(i.empty)return i.makesEpsilon=!1,i;i.annotateNullables();var s=i.symbolMap[i.start].nullable;newRules=[];for(var a=0;a<i.rules.length;++a){var o=i.rules[a];if(0!=o.production.length){for(var l=[],u=0;u<o.production.length;++u)"NT"==o.production[u].type&&i.symbolMap[o.production[u].data].nullable&&l.push(u);if(0!=l.length)for(var h=l.length==o.production.length?1:0,p=Math.pow(2,l.length)-h,u=0;p>u;++u){for(var c=e(l,u),f=[],d=0;d<o.production.length;++d)-1==c.indexOf(d)&&f.push(o.production[d]);newRules.push(n(o.name,f))}else newRules.push(o)}}return 0==newRules.length?{empty:!0,makesEpsilon:s}:(i=t(newRules,i.start),r(0==i.annotateNullables().length,"Having removed nullables, there are still nullables."),i=i.stripped(),i.makesEpsilon=s,r(i.empty||0==i.annotateSelfDeriving().length,"Removing nullables and unit productions did not prevent self-deriving, somehow."),i)}}},{"./assert":3,"./types":9}],3:[function(t,e){e.exports=function(t,e){if(!t)throw new Error(e)}},{}],4:[function(t,e){function n(t,e,n,a){function o(t,e){return i.PRODUCECOUNT=l,{string:t,acceptedByFirst:e}}if(n=n||10,a=a||20,0>a||1>n)return!1;var l=i.PRODUCECOUNT;i.PRODUCECOUNT=i.PRODUCEONE;for(var u=s(t),h=s(e),p=0;a>p;++p){var c=u(p),f=h(p);if(null!==c||null!==f){if(null!==c&&null===f)return r(1===i.parse(t,c).length,'Generated a string "'+c+'" which did not parse.'),o(c,!0);if(null===c&&null!==f)return r(1===i.parse(e,f).length,'Generated a string "'+f+'" which did not parse.'),o(f,!1);for(var d=0;n>d;++d){if(c=u(p),1!==i.parse(e,c).length)return o(c,!0);if(f=h(p),1!==i.parse(t,f).length)return o(f,!1)}}}return i.PRODUCECOUNT=l,!1}var r=t("./assert"),i=t("./parser"),s=t("./generate");e.exports.locatableDifference=n},{"./assert":3,"./generate":5,"./parser":7}],5:[function(t,e){function n(t){for(var e=0,n=0;n<t.length;++n)e+=t[n];return e}function r(t){var e=n(t);if(0==e)return-1;for(var r=Math.random(),i=0;i<t.length;++i){var s=t[i]/e;if(s>r)return i;r-=s}return console.log("No choices? This shouldn't really happen.",r),t.length-1}function i(t){function e(e,r){if(e in u||(u[e]={}),r in u[e])return u[e][r];for(var s=[],a=0;a<t.symbolMap[e].rules.length;++a)s.push(n(i(e,a,0,r)));return u[e][r]=s,s}function i(r,s,a,o){if(0==o)return[];if(r in h||(h[r]={}),s in h[r]||(h[r][s]={}),a in h[r][s]||(h[r][s][a]={}),o in h[r][s][a])return h[r][s][a][o];var l,u=t.symbolMap[r].rules[s].production[a],p=t.symbolMap[r].rules[s].production.length-1;if("T"==u.type)l=a==p?1==o?[1]:[0]:[n(i(r,s,a+1,o-1))];else if(a==p)l=[n(e(u.data,o))];else{l=[];for(var c=1;o-p+a>=c;++c)l.push(n(e(u.data,c))*n(i(r,s,a+1,o-c)))}return h[r][s][a][o]=l,l}function a(t,n){var i=r(e(t,n));return-1==i?null:o(t,i,0,n)}function o(e,n,l,u){var h=t.symbolMap[e].rules[n].production[l],p=t.symbolMap[e].rules[n].production.length-1;if("T"==h.type)return l==p?h.data:h.data+o(e,n,l+1,u-1);if(l==p)return a(h.data,u);var c=r(i(e,n,l,u));return s(-1!==c,"Couldn't find a valid choice."),a(h.data,c+1)+o(e,n,l+1,u-(c+1))}function l(e){return 0==e?t.makesEpsilon?"":null:t.empty?null:a(t.start,e)}if(t=t.deNulled(),!t.empty&&t.annotateSelfDeriving().length>0)throw Error("Generator does not work when there are infinitely many parses for a string. (ie, when A*=>A is possible.)");var u={},h={};return l.findLength=function(n,i){if(t.empty)return t.makesEpsilon?-2:-3;if(n=n||0,i=i||10,0==n&&t.makesEpsilon)return 0;for(var s=n;n+i>s;++s)if(-1!==r(e(t.start,s)))return s;return-1},l.findLengths=function(n,i){if(n=n||0,i=i||10,t.empty)return t.makesEpsilon?0==n?[0]:[]:null;var s=[];0==n&&(t.makesEpsilon&&s.push(0),n=1);for(var a=n;n+i>a;++a)-1!==r(e(t.start,a))&&s.push(a);return s},l}var s=t("./assert");e.exports=i},{"./assert":3}],6:[function(t,e,n){e.exports=n={types:t("./types"),generator:t("./generate"),parser:t("./parser"),checks:t("./check"),printers:t("./printers")}},{"./check":4,"./generate":5,"./parser":7,"./printers":8,"./types":9}],7:[function(t,e){function n(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}function r(t,e,n,i){return this instanceof r?(this.rule=t,this.index=e,this.predecessor=n,this.backPointers=i||[],void s(this.index==this.backPointers.length)):new r(t,e,n,i)}function i(t,e,n){function i(t,e){for(var n=0,r=0;r<p[e].length;++r){var i=t.compare(p[e][r]);if(i==l.IDENTICAL||i==l.SIMILAR&&o.PRODUCECOUNT==l.PRODUCEONE)return!0;if(i==l.SIMILAR&&o.PRODUCECOUNT==l.PRODUCETWO&&++n>1)return!0}return!1}function s(t,n){if(t.next().equals(T(e[n]))){var s=t.backPointers.slice(0);s.push(null);var a=r(t.rule,t.index+1,t.predecessor,s);i(a,n+1)||p[n+1].push(a)}}function a(e,n){for(var s=e.next(),a=0;a<t.symbolMap[s.data].rules.length;++a){var o=r(t.symbolMap[s.data].rules[a],0,n);i(o,n)||p[n].push(o)}for(var a=0;a<p[n].length;++a){var l=p[n][a];if(l.rule.name===s.data&&l.predecessor===n&&l.done()){var u=e.backPointers.slice(0);u.push(l);var o=r(e.rule,e.index+1,e.predecessor,u);i(o,n)||p[n].push(o)}}}function u(t,e){for(var n=NT(t.rule.name),s=0;s<p[t.predecessor].length;++s){var a=p[t.predecessor][s];if(!a.done()&&n.equals(a.next())){var o=a.backPointers.slice(0);o.push(t);var l=r(a.rule,a.index+1,a.predecessor,o);i(l,e)||p[e].push(l)}}}if("string"!=typeof e)throw Error("Can't parse non-string object "+typeof e);var h=o.PRODUCECOUNT;n&&(o.PRODUCECOUNT=n);for(var p=[],c=0;c<=e.length;++c)p.push([]);if(o.PRODUCECOUNT==l.PRODUCEALL&&0!==t.annotateSelfDeriving().length)throw Error("Asked for all parses, but grammar can produce infinitely many parses for some string. Check grammar.annotateSelfDeriving() for specifics.");var f=t.start,d=Rule(["GAMMA"],[NT(f)]);p[0].push(r(d,0,0));for(var c=0;c<=e.length;++c)for(var m=0;m<p[c].length;++m){var v=p[c][m];v.done()?u(v,c):"NT"==v.next().type?a(v,c):s(v,c)}for(var g=[],c=0;c<p[e.length].length;++c){var v=p[e.length][c];v.rule===d&&v.done()&&g.push(v)}return o.PRODUCECOUNT=h,g}var s=t("./assert"),a=t("./types");t("./algorithms")(a.Grammar);var o={},l={DISTINCT:{},SIMILAR:{},IDENTICAL:{},PRODUCEONE:{},PRODUCETWO:{},PRODUCEALL:{}};o.PRODUCEONE=l.PRODUCEONE,o.PRODUCETWO=l.PRODUCETWO,o.PRODUCEALL=l.PRODUCEALL,o.PRODUCECOUNT=l.PRODUCETWO,NT=a.NT,T=a.T,Rule=a.Rule,Grammar=a.Grammar,r.prototype.done=function(){return this.index===this.rule.production.length},r.prototype.compare=function(t){return this.rule===t.rule&&this.index===t.index&&this.predecessor===t.predecessor?n(this.backPointers,t.backPointers)?l.IDENTICAL:l.SIMILAR:l.DISTINCT},r.prototype.next=function(){return this.rule.production[this.index]},r.prototype.toString=function(){return"("+this.rule.name+" -> "+this.rule.production.slice(0,this.index).join("")+"*"+this.rule.production.slice(this.index).join("")+", "+this.predecessor.toString()+")"},o.parse=i,e.exports=o},{"./algorithms":2,"./assert":3,"./types":9}],8:[function(t,e){function n(t,e){e=0|e;for(var r="",i=0;e>i;++i)r+=h;console.log(r+t.rule),r+=h;for(var i=0;i<t.backPointers.length;++i){var s=t.backPointers[i];null===s?console.log(r+t.rule.production[i].data):n(s,e+1)}}function r(t){function e(t){for(var e="",r=0;r<n.length;++r)e+=r==t?"*"+n[r].rule.name+"*":"string"==typeof n[r]?n[r]:n[r].rule.name;return e}for(var n=[t],r=0;r<n.length;++r)if("string"!=typeof n[r]){var i=n[r],s=i.rule.toString()+"  |  ";s+=e(r)+"  |  ";for(var a=[],o=0;o<i.index;++o)a.push("T"==i.rule.production[o].type?i.rule.production[o].data:i.backPointers[o]);n=n.slice(0,r).concat(a).concat(n.slice(r+1)),s+=e(-1),console.log(s),--r}}function i(t,e,n,r){function i(t){if(e&&1===t.backPointers.length){var a=t.backPointers[0];return null===a?{type:"Terminal",value:t.rule.production[0].data}:i(a)}for(var o={type:s?r(t.rule):t.rule,children:[]},l=!(n&&t.backPointers.some(function(t){return null!==t})),u=0;u<t.backPointers.length;++u){var h=t.backPointers[u];null===h?l&&o.children.push({type:"Terminal",value:t.rule.production[u].data}):o.children.push(i(h))}return o}var s="function"==typeof r;return i(t.backPointers[0])}function s(t){var e=document.createElement("span");if(0==t.length)e.appendChild(document.createTextNode("ɛ"));else for(var n=0;n<t.length;++n)if("T"==t[n].type)e.appendChild(document.createTextNode(t[n].data));else{var r=document.createElement("span");r.className="cfg-symbol",r.appendChild(document.createTextNode(t[n].data)),e.appendChild(r)}return e}function a(t){var e=document.createElement("span");e.className="cfg-rule";var n=document.createElement("span");return n.className="cfg-symbol",n.appendChild(document.createTextNode(t.name)),e.appendChild(n),e.appendChild(document.createTextNode(" → ")),e.appendChild(s(t.production)),e}function o(t){function e(t,e){("number"!=typeof e||0>e)&&(e=1);var r=document.createElement("span");c=r;for(var i=0;i<n.length;++i)if(i==t&&(c=document.createElement("span"),c.className="cfg-rewrite",r.appendChild(c)),i-t>=e&&(c=r),"string"==typeof n[i])c.appendChild(document.createTextNode(n[i]));else{var s=document.createElement("span");s.className="cfg-symbol",s.appendChild(document.createTextNode(n[i].rule.name)),c.appendChild(s)}return r}var n=[t],r=document.createElement("table");r.className="cfg-derivations derivations",r.innerHTML="<thead><tr><th>Rule</th><th>Application</th><th>Result</th></tr></thead>";var i=document.createElement("tr"),s=document.createElement("td"),o=document.createElement("sp");o.className="cfg-rule",o.innerHTML='Start → <span class="cfg-symbol">'+t.backPointers[0].rule.name+"</span>",s.appendChild(o),i.appendChild(s),s=document.createElement("td");var o=document.createElement("span");o.className="cfg-start",o.appendChild(document.createTextNode("Start")),s.appendChild(o),i.appendChild(s),n=[t.backPointers[0]],s=document.createElement("td"),s.appendChild(e(-1)),i.appendChild(s),r.appendChild(i);for(var l=0;l<n.length;++l)if("string"!=typeof n[l]){var u=n[l],i=document.createElement("tr"),s=document.createElement("td");s.appendChild(a(u.rule)),i.appendChild(s),s=document.createElement("td"),s.appendChild(e(l)),i.appendChild(s);for(var h=[],p=0;p<u.index;++p)h.push("T"==u.rule.production[p].type?u.rule.production[p].data:u.backPointers[p]);n=n.slice(0,l).concat(h).concat(n.slice(l+1)),s=document.createElement("td"),s.appendChild(e(l,h.length)),i.appendChild(s),r.appendChild(i),--l}return r}function l(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML}function u(t){var e=document.createElement("div"),n=document.createElement("span");n.innerHTML='Start symbol: <span class="cfg-symbol">'+l(t.start)+"</span>",e.appendChild(n),e.appendChild(document.createElement("br"));for(var r=0;r<t.symbolsList.length;++r){var i=t.symbolsList[r];n=document.createElement("span");var a=document.createElement("span");a.className="cfg-symbol",a.appendChild(document.createTextNode(i)),n.appendChild(a),n.appendChild(document.createTextNode(" → "));for(var o=0;o<t.symbolMap[i].rules.length;++o){o>0&&n.appendChild(document.createTextNode(" | "));var u=t.symbolMap[i].rules[o];n.appendChild(s(u.production))}e.appendChild(n),e.appendChild(document.createElement("br"))}return e}var h="  ";e.exports={subtreePrinter:n,rewritePrinter:r,astPrinter:i,domPrinter:o,domGrammarPrinter:u}},{}],9:[function(t,e){function n(t,e){this.type=t,this.data=e}function r(t){return new n("NT",t)}function i(t){return new n("T",t)}function s(t){return t.replace(/['\\]/g,function(t){return"\\"+t}).replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function a(t,e){return this instanceof a?(this.name=t,void(this.production=e)):new a(t,e)}function o(t,e){if(!(this instanceof o))return new o(t,e);this.rules=t,this.start=e||t[0].name,this.symbolMap={},this.symbolsList=e?[e]:[],e&&(this.symbolMap[e]={rules:[]});for(var n=0;n<this.rules.length;++n){var r=this.rules[n].name;r in this.symbolMap||(this.symbolMap[r]={rules:[]},this.symbolsList.push(r));for(var i=0;i<this.rules[n].production.length;++i){var s=this.rules[n].production[i];"NT"!=s.type||s.data in this.symbolMap||(this.symbolMap[s.data]={rules:[]},this.symbolsList.push(s.data))}this.symbolMap[r].rules.push(this.rules[n])}}n.prototype.equals=function(t){return t.type===this.type&&t.data===this.data},n.prototype.toString=function(){return this.data.toString()},a.prototype.equals=function(t){if(t.name!==this.name)return!1;if(t.production.length!==this.production.length)return!1;for(var e=0;e<t.production.length;++e)if(!t.production[e].equals(this.production[e]))return!1;return!0},a.prototype.toString=function(){return this.name+" -> "+this.production.join("")},a.prototype.repr=function(){for(var t="Rule('"+s(this.name)+"', [",e=0;e<this.production.length;++e)e>0&&(t+=", "),t+=this.production[e].type+"('"+s(this.production[e].data)+"')";return t+="])"},o.prototype.repr=function(){for(var t="Grammar([\n  ",e=0;e<this.rules.length;++e)e>0&&(t+=",\n  "),t+=this.rules[e].repr();return t+="\n], '"+s(this.start)+"')"},o.prototype.getReverseMap=function(){if(!this.hasOwnProperty("_reverseMap")){this._reverseMap={};for(var t=0;t<this.symbolsList.length;++t)this._reverseMap[this.symbolsList[t]]=[];for(var t=0;t<this.rules.length;++t)for(var e=this.rules[t],n=0;n<e.production.length;++n)"NT"===e.production[n].type&&this._reverseMap[e.production[n].data].push(e)}return this._reverseMap},e.exports={Sym:n,NT:r,T:i,Rule:a,Grammar:o}},{}],10:[function(t,e){"use strict";function n(t,e,n,r){this.alphabet=t.slice(0),this.states=Object.getOwnPropertyNames(e).sort(),this.delta=e,this.initial=n,this.final=r.slice(0),this.isMinimized=!1}function r(t,e,n,r){this.alphabet=t.slice(0),this.states=Object.getOwnPropertyNames(e).sort(),this.delta=e,this.initial=n.slice(0),this.final=r.slice(0)}function i(t){return t.filter(function(t,e,n){return n.indexOf(t)==e}).sort()}function s(t){return t.replace(/["\\]/g,function(t){return"\\"+t}).replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function a(t,e,n,r){var i=r.state_fn||function(){},s=r.get_name||function(t){return t},a=r.should_exit||function(){return!1};if(a(e))return"";if("object"==typeof n){var o=n;n=function(t,e){return o[t][e]}}var l=Object.create(null);l[s(e)]="";for(var u=[e];u.length>0;){var h=u.shift(),p=s(h);i(h);for(var c=0;c<t.length;++c){var f=t[c],d=n(h,f),m=s(d);if(a(d))return l[h]+f;void 0===l[m]&&(l[m]=l[p]+f,u.push(d))}}return null}n.prototype.accepts=function(t){for(var e=this.initial,n=0;n<t.length;++n)e=this.delta[e][t[n]];return-1!==this.final.indexOf(e)},n.prototype.test=function(t){return this.accepts(t)},n.prototype.to_NFA=function(){for(var t={},e=0;e<this.states.length;++e){var n=this.states[e];t[n]={};for(var i=0;i<this.alphabet.length;++i)t[n][this.alphabet[i]]=[this.delta[n][this.alphabet[i]]]}return new r(this.alphabet,t,[this.initial],this.final)},n.prototype.minimized=function(){var t=this.to_NFA().reversed().to_DFA().to_NFA().reversed().to_DFA();return t.isMinimized=!0,t},n.prototype.without_unreachables=function(){var t={};a(this.alphabet,this.initial,this.delta,{state_fn:function(e){t[e]=!0}});for(var e={},r=Object.getOwnPropertyNames(t),i=0;i<r.length;++i)e[r[i]]=this.delta[r[i]];var s=this.final.filter(t.hasOwnProperty.bind(t));return new n(this.alphabet,e,this.initial,s)},n.prototype.complemented=function(){var t=this.final;return new n(this.alphabet,this.delta,this.initial,this.states.filter(function(e){return-1===t.indexOf(e)}))},n.prototype.find_passing=function(){return a(this.alphabet,this.initial,this.delta,{should_exit:function(t){return-1!==this.final.indexOf(t)}.bind(this)})},n.prototype.intersect=function(t){function e(e){return this.states.indexOf(e[0])+" "+t.states.indexOf(e[1])}function r(n,r){var i=[u.delta[n[0]][r],t.delta[n[1]][r]];return l[e(n)][r]=e(i),i}function i(n){var r=e(n);l[r]={},-1!==u.final.indexOf(n[0])&&-1!==t.final.indexOf(n[1])&&o.push(r)}e=e.bind(this);var s=[this.initial,t.initial],o=[],l={},u=this;return a(this.alphabet,s,r,{get_name:e,state_fn:i}),new n(this.alphabet,l,e(s),o)},n.prototype.find_equivalence_counterexamples=function(t){return[this.intersect(t.complemented()).find_passing(),t.intersect(this.complemented()).find_passing()]},n.prototype.dottified=function(){var t='digraph foo {\n  rankdir=LR;\n  "__start" [style=invis label="" shape=plain];\n  node [shape=circle];',e=this;return this.states.filter(function(t){return-1==e.final.indexOf(t)}).forEach(function(e){t+=' "'+s(e)+'";'}),t+="\n  node [shape = doublecircle];",this.final.forEach(function(e){t+=' "'+s(e)+'";'}),t+='\n  "__start" -> "'+s(this.initial)+'";',this.states.forEach(function(n){var r={};e.states.forEach(function(t){r[t]=[]}),e.alphabet.forEach(function(t){r[e.delta[n][t]].push(t)}),e.states.forEach(function(e){0!==r[e].length&&(t+='\n  "'+s(n)+'" -> "'+s(e)+'" [label="'+r[e].map(s).join(",")+'"];')})}),t+="\n}\n"},n.prototype.serialized=function(){function t(t){return e.indexOf(t)}var e=[];a(this.alphabet,this.initial,this.delta,{state_fn:function(t){e.push(t)}});for(var n=this.alphabet.slice(0).sort(),r="{",i=0;i<e.length;++i){0!==i&&(r+=", "),r+='"'+i+'": {';for(var o=0;o<n.length;++o){var l=n[o];0!==o&&(r+=", "),r+='"'+s(l)+'": "'+t(this.delta[e[i]][l])+'"'}r+="}"}r+="}";var u="{";return u+='"alphabet": ['+n.map(s).map(function(t){return'"'+t+'"'}).join(",")+"], ",u+='"delta": '+r+", ",u+='"initial": "'+t(this.initial)+'", ',u+='"final": ['+this.final.map(t).sort().map(function(t){return'"'+t+'"'}).join(",")+"]}"},r.prototype.epsilon_closure=function(t){for(var e=i(t),n=e.slice(0);n.length>0;){var r=n.pop(),s=this.delta[r][""];if(void 0!==s)for(var a=0;a<s.length;++a)-1===n.indexOf(s[a])&&-1===e.indexOf(s[a])&&(n.push(s[a]),e.push(s[a]))}return e},r.prototype.step=function(t,e){var n=this.delta;return t=t.map(function(t){var r=n[t][e];return void 0===r?[]:r}),0===t.length?t:(t=t.reduce(function(t,e){return t.concat(e)}),this.epsilon_closure(t))},r.prototype.accepts=function(t){for(var e=this.epsilon_closure(this.initial),n=0;n<t.length;++n)e=this.step(e,t[n]);for(n=0;n<this.final.length;++n)if(-1!==e.indexOf(this.final[n]))return!0;return!1},r.prototype.test=function(t){return this.accepts(t)},r.prototype.to_DFA=function(){function t(t){return t.map(this.states.indexOf.bind(this.states)).sort().join(" ")}function e(e,n){var r=l.step(e,n);return o[t(e)][n]=t(r),r}function r(e){var n=t(e);o[n]={};for(var r=0;r<l.final.length;++r)if(-1!==e.indexOf(l.final[r])){s.push(n);break}}t=t.bind(this);var i=this.epsilon_closure(this.initial),s=[],o={},l=this;return a(this.alphabet,i,e,{get_name:t,state_fn:r}),new n(this.alphabet,o,t(i),s)},r.prototype.minimized=function(){return this.to_DFA().minimized()},r.prototype.reversed=function(){for(var t={},e=0;e<this.states.length;++e)t[this.states[e]]={};for(e=0;e<this.states.length;++e)for(var n=this.states[e],s=0;s<=this.alphabet.length;++s){var a=s==this.alphabet.length?"":this.alphabet[s],o=this.delta[n][a];if(void 0!==o)for(var l=0;l<o.length;++l){var u=t[o[l]][a];t[o[l]][a]=void 0===u?[n]:i(u.concat([n]))}}return new r(this.alphabet,t,this.final,this.initial)},r.prototype._clone=function(t){function e(e){return""+t+this.states.indexOf(e)}e=e.bind(this);for(var n={},i=0;i<this.states.length;++i){var s=this.states[i],a=e(s);n[a]={};for(var o=0;o<=this.alphabet.length;++o){var l=o==this.alphabet.length?"":this.alphabet[o],u=this.delta[s][l];void 0!==u&&(n[a][l]=u.map(e))}}return new r(this.alphabet,n,this.initial.map(e),this.final.map(e))},r.prototype.concat=function(t){for(var e=this._clone("q"),n=t._clone("r"),i=0;i<n.states.length;++i){var s=n.states[i];e.delta[s]=n.delta[s]}for(i=0;i<e.final.length;++i){var s=e.final[i],a=e.delta[s][""];void 0===a&&(a=e.delta[s][""]=[]);for(var o=0;o<n.initial.length;++o)a.push(n.initial[o])}return new r(this.alphabet,e.delta,e.initial,n.final)},r.prototype.union=function(t){for(var e=this._clone("q"),n=t._clone("r"),i=0;i<n.states.length;++i){var s=n.states[i];e.delta[s]=n.delta[s]}return e.delta.s={"":e.initial.concat(n.initial)},new r(this.alphabet,e.delta,["s"],e.final.concat(n.final))},r.prototype.star=function(){var t=this._clone("q");t.delta.s={"":t.initial};for(var e=0;e<t.final.length;++e){var n=t.final[e],i=t.delta[n][""];void 0===i&&(i=t.delta[n][""]=[]),i.push("s")}return new r(t.alphabet,t.delta,["s"],["s"])},r.prototype.plus=function(){for(var t=this._clone("q"),e=0;e<t.final.length;++e){var n=t.final[e],r=t.delta[n][""];void 0===r&&(r=t.delta[n][""]=[]);for(var i=0;i<t.initial.length;++i)r.push(t.initial[i])}return t},r.prototype.repeat=function(t){if(0>t)throw"Can't repeat a negative number of times ("+t+")";return 0===t?r.for("",this.alphabet):1===t?this:this.concat(this.repeat(t-1))},r.prototype.optional=function(){var t=this._clone("q");return t.delta.s={"":t.initial},new r(t.alphabet,t.delta,["s"],t.final.concat(["s"]))},r.for=function(t,e){for(var n="s",i={s:{}},s=0;s<t.length;++s){var a="q"+(s+1);i[n][t[s]]=[a],i[a]={},n=a}return new r(e,i,["s"],[n])},r.prototype.dottified=function(){var t='digraph foo {\n  rankdir=LR;\n  "__start" [style=invis label="" shape=plain];\n  node [shape=circle];',e=this;return this.states.filter(function(t){return-1==e.final.indexOf(t)}).forEach(function(e){t+=' "'+s(e)+'";'}),t+="\n  node [shape = doublecircle];",this.final.forEach(function(e){t+=' "'+s(e)+'";'}),this.initial.forEach(function(e){t+='\n  "__start" -> "'+s(e)+'";'}),this.states.forEach(function(n){var r={};e.states.forEach(function(t){r[t]=[]}),e.alphabet.concat("").forEach(function(t){var i=e.delta[n][t];void 0!==i&&(""===t&&(t="_"),i.forEach(function(e){r[e].push(t)}))}),e.states.forEach(function(e){0!==r[e].length&&(t+='\n  "'+s(n)+'" -> "'+s(e)+'" [label="'+r[e].map(s).join(",")+'"];')})}),t+="\n}\n"},e.exports.NFA=r,e.exports.DFA=n},{}],11:[function(t,e){function n(t){switch(p.indexOf(t)){case 0:return"Union";case 1:return"EmptyUnion";case 2:return"Empty";case 4:return"Concatenation";case 6:return"Option";case 8:return"Star";case 9:return"Plus";case 10:return"Repetition";case 12:return"Paren";case 15:return"Digits";default:throw"Unreachable: "+p.indexOf(t)}}function r(t,e){var r=Grammar(p.concat(e.map(function(t){return Rule("L",[T(t)])})),"U"),i=h.parse(r,t);if(1!==i.length)throw"Couldn't unambiguously parse: "+i.length;return u(i[0],!0,!0,n)}function i(t){return t.replace(/[\|\*\+\^\?\(\)0-9]/g,"").split("").filter(function(t,e,n){return n.indexOf(t)===e}).sort()}function s(t,e){function n(t){switch(t.type){case"Union":return n(t.children[0]).union(n(t.children[1]));case"EmptyUnion":return n(t.children[0]).optional();case"Empty":return l.for("",e);case"Concatenation":return n(t.children[0]).concat(n(t.children[1]));case"Option":return n(t.children[0]).optional();case"Star":return n(t.children[0]).star();case"Plus":return n(t.children[0]).plus();case"Repetition":return n(t.children[0]).repeat(parseInt(s(t.children[1])));case"Paren":return n(t.children[0]);case"Terminal":return l.for(t.value,e);default:throw"Unreachable: "+t.type}}function s(t){return"Digits"===t.type?s(t.children[0])+s(t.children[1]):t.value}return"undefined"==typeof e?e=i(t):"string"==typeof e&&(e=e.split("")),n(r(t,e))}var a=t("cfgrammar-tool"),o=t("dfa-lib"),l=o.NFA,u=a.printers.astPrinter,h=a.parser,p=[Rule("U",[NT("C"),T("|"),NT("U")]),Rule("U",[T("|"),NT("U")]),Rule("U",[]),Rule("U",[NT("C")]),Rule("C",[NT("O"),NT("C")]),Rule("C",[NT("O")]),Rule("O",[NT("R"),T("?")]),Rule("O",[NT("R")]),Rule("R",[NT("A"),T("*")]),Rule("R",[NT("A"),T("+")]),Rule("R",[NT("A"),T("^"),NT("I")]),Rule("R",[NT("A")]),Rule("A",[T("("),NT("U"),T(")")]),Rule("A",[NT("L")]),Rule("I",[NT("D")]),Rule("I",[NT("I"),NT("D")]),Rule("D",[T("0")]),Rule("D",[T("1")]),Rule("D",[T("2")]),Rule("D",[T("3")]),Rule("D",[T("4")]),Rule("D",[T("5")]),Rule("D",[T("6")]),Rule("D",[T("7")]),Rule("D",[T("8")]),Rule("D",[T("9")])];e.exports=s,e.exports.parse=r},{"cfgrammar-tool":6,"dfa-lib":10}]},{},[1]);